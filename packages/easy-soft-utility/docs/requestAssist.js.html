<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>requestAssist.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css" />
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css" />
    <script src="scripts/nav.js" defer></script>

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body>
    <input type="checkbox" id="nav-trigger" class="nav-trigger" />
    <label for="nav-trigger" class="navicon-button x">
      <div class="navicon"></div>
    </label>

    <label for="nav-trigger" class="overlay"></label>

    <nav>
      <h2><a href="index.html">Home</a></h2>
      <h3>Global</h3>
      <ul>
        <li>
          <a href="global.html#accessWaySpecialCollection"
            >accessWaySpecialCollection</a
          >
        </li>
        <li><a href="global.html#addHour">addHour</a></li>
        <li><a href="global.html#addMinute">addMinute</a></li>
        <li><a href="global.html#addSecond">addSecond</a></li>
        <li><a href="global.html#alignHorizontal">alignHorizontal</a></li>
        <li><a href="global.html#alignVertical">alignVertical</a></li>
        <li><a href="global.html#appendEmbedBuilder">appendEmbedBuilder</a></li>
        <li><a href="global.html#appendExtraBuilder">appendExtraBuilder</a></li>
        <li>
          <a href="global.html#applicationConfiguration"
            >applicationConfiguration</a
          >
        </li>
        <li><a href="global.html#authorityAssist">authorityAssist</a></li>
        <li><a href="global.html#averageArray">averageArray</a></li>
        <li>
          <a href="global.html#buildFieldDescription">buildFieldDescription</a>
        </li>
        <li><a href="global.html#buildFieldHelper">buildFieldHelper</a></li>
        <li><a href="global.html#buildHexColor">buildHexColor</a></li>
        <li>
          <a href="global.html#buildLinearGradient">buildLinearGradient</a>
        </li>
        <li>
          <a href="global.html#buildModelCollection">buildModelCollection</a>
        </li>
        <li>
          <a href="global.html#buildPromptModuleInfo">buildPromptModuleInfo</a>
        </li>
        <li>
          <a href="global.html#buildQueryStringify">buildQueryStringify</a>
        </li>
        <li>
          <a href="global.html#buildRGBColorFromHexColor"
            >buildRGBColorFromHexColor</a
          >
        </li>
        <li>
          <a href="global.html#buildRandomHexColor">buildRandomHexColor</a>
        </li>
        <li>
          <a href="global.html#buildSimulateRequestFailResponse"
            >buildSimulateRequestFailResponse</a
          >
        </li>
        <li>
          <a href="global.html#buildSimulateRequestSuccessResponse"
            >buildSimulateRequestSuccessResponse</a
          >
        </li>
        <li><a href="global.html#buildStringStyle">buildStringStyle</a></li>
        <li><a href="global.html#buildTokenData">buildTokenData</a></li>
        <li>
          <a href="global.html#calculateDateInterval">calculateDateInterval</a>
        </li>
        <li>
          <a href="global.html#calculateMonthInterval"
            >calculateMonthInterval</a
          >
        </li>
        <li>
          <a href="global.html#calculateTimeInterval">calculateTimeInterval</a>
        </li>
        <li><a href="global.html#checkDarkMode">checkDarkMode</a></li>
        <li><a href="global.html#checkExist">checkExist</a></li>
        <li><a href="global.html#checkHasMore">checkHasMore</a></li>
        <li><a href="global.html#checkInCollection">checkInCollection</a></li>
        <li><a href="global.html#checkKey">checkKey</a></li>
        <li>
          <a href="global.html#checkObjectIsNullOrEmpty"
            >checkObjectIsNullOrEmpty</a
          >
        </li>
        <li>
          <a href="global.html#checkStringIsNullOrWhiteSpace"
            >checkStringIsNullOrWhiteSpace</a
          >
        </li>
        <li>
          <a href="global.html#checkWhetherDevelopmentEnvironment"
            >checkWhetherDevelopmentEnvironment</a
          >
        </li>
        <li>
          <a href="global.html#compareTimeGreaterThan"
            >compareTimeGreaterThan</a
          >
        </li>
        <li>
          <a href="global.html#compareTimeLessThan">compareTimeLessThan</a>
        </li>
        <li><a href="global.html#convertCollection">convertCollection</a></li>
        <li><a href="global.html#convertPixelToRem">convertPixelToRem</a></li>
        <li>
          <a href="global.html#createDayJsDatetime">createDayJsDatetime</a>
        </li>
        <li>
          <a href="global.html#dataExceptionNotice">dataExceptionNotice</a>
        </li>
        <li><a href="global.html#datetimeFormat">datetimeFormat</a></li>
        <li><a href="global.html#debounce">debounce</a></li>
        <li><a href="global.html#decodeBase64">decodeBase64</a></li>
        <li><a href="global.html#deleteCache">deleteCache</a></li>
        <li><a href="global.html#deleteMultiCache">deleteMultiCache</a></li>
        <li>
          <a href="global.html#displayObjectMessage">displayObjectMessage</a>
        </li>
        <li><a href="global.html#displayTextMessage">displayTextMessage</a></li>
        <li><a href="global.html#ellipsis">ellipsis</a></li>
        <li><a href="global.html#emptyDatetime">emptyDatetime</a></li>
        <li><a href="global.html#encodeBase64">encodeBase64</a></li>
        <li><a href="global.html#endsWith">endsWith</a></li>
        <li>
          <a href="global.html#environmentCollection">environmentCollection</a>
        </li>
        <li><a href="global.html#errorCustomData">errorCustomData</a></li>
        <li><a href="global.html#errorImage">errorImage</a></li>
        <li><a href="global.html#evil">evil</a></li>
        <li><a href="global.html#filter">filter</a></li>
        <li><a href="global.html#find">find</a></li>
        <li><a href="global.html#findIndex">findIndex</a></li>
        <li><a href="global.html#flushAllCache">flushAllCache</a></li>
        <li><a href="global.html#flushLocalStorage">flushLocalStorage</a></li>
        <li>
          <a href="global.html#flushSessionStorage">flushSessionStorage</a>
        </li>
        <li><a href="global.html#formatCollection">formatCollection</a></li>
        <li><a href="global.html#formatDateInterval">formatDateInterval</a></li>
        <li>
          <a href="global.html#formatDateIntervalWithNow"
            >formatDateIntervalWithNow</a
          >
        </li>
        <li><a href="global.html#formatDecimal">formatDecimal</a></li>
        <li><a href="global.html#formatMoney">formatMoney</a></li>
        <li>
          <a href="global.html#formatMoneyToChinese">formatMoneyToChinese</a>
        </li>
        <li>
          <a href="global.html#getAccessWayCollectionCache"
            >getAccessWayCollectionCache</a
          >
        </li>
        <li>
          <a href="global.html#getApplicationExternalConfigList"
            >getApplicationExternalConfigList</a
          >
        </li>
        <li>
          <a href="global.html#getApplicationInitialConfig"
            >getApplicationInitialConfig</a
          >
        </li>
        <li>
          <a href="global.html#getApplicationMergeConfig"
            >getApplicationMergeConfig</a
          >
        </li>
        <li><a href="global.html#getBrowserInfo">getBrowserInfo</a></li>
        <li><a href="global.html#getBrowserVersion">getBrowserVersion</a></li>
        <li><a href="global.html#getBuilderCount">getBuilderCount</a></li>
        <li><a href="global.html#getCache">getCache</a></li>
        <li><a href="global.html#getCachePool">getCachePool</a></li>
        <li>
          <a href="global.html#getCurrentOperatorCache"
            >getCurrentOperatorCache</a
          >
        </li>
        <li>
          <a href="global.html#getCurrentOperatorCacheKey"
            >getCurrentOperatorCacheKey</a
          >
        </li>
        <li><a href="global.html#getExpiration">getExpiration</a></li>
        <li><a href="global.html#getGuid">getGuid</a></li>
        <li>
          <a href="global.html#getJsonFromLocalStorage"
            >getJsonFromLocalStorage</a
          >
        </li>
        <li>
          <a href="global.html#getJsonFromSessionStorage"
            >getJsonFromSessionStorage</a
          >
        </li>
        <li><a href="global.html#getLocalMetaData">getLocalMetaData</a></li>
        <li>
          <a href="global.html#getLocalMetaDataCacheKey"
            >getLocalMetaDataCacheKey</a
          >
        </li>
        <li>
          <a href="global.html#getLoggerDisplaySwitch"
            >getLoggerDisplaySwitch</a
          >
        </li>
        <li><a href="global.html#getModelCollection">getModelCollection</a></li>
        <li><a href="global.html#getModelNameList">getModelNameList</a></li>
        <li><a href="global.html#getMultiCache">getMultiCache</a></li>
        <li><a href="global.html#getNow">getNow</a></li>
        <li>
          <a href="global.html#getParametersDataCache"
            >getParametersDataCache</a
          >
        </li>
        <li><a href="global.html#getPathValue">getPathValue</a></li>
        <li>
          <a href="global.html#getStringFromLocalStorage"
            >getStringFromLocalStorage</a
          >
        </li>
        <li>
          <a href="global.html#getStringFromSessionStorage"
            >getStringFromSessionStorage</a
          >
        </li>
        <li><a href="global.html#getTacitlyState">getTacitlyState</a></li>
        <li><a href="global.html#getTimeStamp">getTimeStamp</a></li>
        <li><a href="global.html#getTodayOfWeek">getTodayOfWeek</a></li>
        <li><a href="global.html#getToken">getToken</a></li>
        <li><a href="global.html#getTokenKeyName">getTokenKeyName</a></li>
        <li><a href="global.html#getValueByKey">getValueByKey</a></li>
        <li>
          <a href="global.html#handleAuthorizationFail"
            >handleAuthorizationFail</a
          >
        </li>
        <li><a href="global.html#handleItem">handleItem</a></li>
        <li>
          <a href="global.html#handleListDataAssist">handleListDataAssist</a>
        </li>
        <li><a href="global.html#handleListItem">handleListItem</a></li>
        <li><a href="global.html#hasCache">hasCache</a></li>
        <li><a href="global.html#hasToken">hasToken</a></li>
        <li><a href="global.html#inYear">inYear</a></li>
        <li><a href="global.html#isAsyncFunction">isAsyncFunction</a></li>
        <li><a href="global.html#isBetweenDatetime">isBetweenDatetime</a></li>
        <li><a href="global.html#isBoolean">isBoolean</a></li>
        <li><a href="global.html#isDate">isDate</a></li>
        <li><a href="global.html#isDatetime">isDatetime</a></li>
        <li><a href="global.html#isEmptyArray">isEmptyArray</a></li>
        <li><a href="global.html#isEmptyObject">isEmptyObject</a></li>
        <li><a href="global.html#isEqual">isEqual</a></li>
        <li><a href="global.html#isEqualBySerialize">isEqualBySerialize</a></li>
        <li><a href="global.html#isFunction">isFunction</a></li>
        <li><a href="global.html#isImageBase4">isImageBase4</a></li>
        <li><a href="global.html#isInvalid">isInvalid</a></li>
        <li><a href="global.html#isMoney">isMoney</a></li>
        <li><a href="global.html#isNull">isNull</a></li>
        <li><a href="global.html#isNumber">isNumber</a></li>
        <li><a href="global.html#isObject">isObject</a></li>
        <li><a href="global.html#isPlainObject">isPlainObject</a></li>
        <li><a href="global.html#isPromise">isPromise</a></li>
        <li><a href="global.html#isString">isString</a></li>
        <li><a href="global.html#isToday">isToday</a></li>
        <li><a href="global.html#isUndefined">isUndefined</a></li>
        <li><a href="global.html#isUrl">isUrl</a></li>
        <li><a href="global.html#isWeekend">isWeekend</a></li>
        <li><a href="global.html#keys">keys</a></li>
        <li><a href="global.html#localStorageAssist">localStorageAssist</a></li>
        <li><a href="global.html#logCallResult">logCallResult</a></li>
        <li><a href="global.html#logCallTrace">logCallTrace</a></li>
        <li><a href="global.html#logCallTrack">logCallTrack</a></li>
        <li><a href="global.html#logConfig">logConfig</a></li>
        <li><a href="global.html#logData">logData</a></li>
        <li><a href="global.html#logDebug">logDebug</a></li>
        <li><a href="global.html#logDevelop">logDevelop</a></li>
        <li><a href="global.html#logDisplay">logDisplay</a></li>
        <li><a href="global.html#logError">logError</a></li>
        <li><a href="global.html#logException">logException</a></li>
        <li><a href="global.html#logExecute">logExecute</a></li>
        <li><a href="global.html#logInfo">logInfo</a></li>
        <li><a href="global.html#logLevel">logLevel</a></li>
        <li><a href="global.html#logObject">logObject</a></li>
        <li><a href="global.html#logRender">logRender</a></li>
        <li><a href="global.html#logStack">logStack</a></li>
        <li><a href="global.html#logText">logText</a></li>
        <li><a href="global.html#logTrace">logTrace</a></li>
        <li><a href="global.html#logWarn">logWarn</a></li>
        <li><a href="global.html#loggerSwitch">loggerSwitch</a></li>
        <li><a href="global.html#mergeArrowText">mergeArrowText</a></li>
        <li><a href="global.html#mergeProperties">mergeProperties</a></li>
        <li><a href="global.html#mergeStyle">mergeStyle</a></li>
        <li>
          <a href="global.html#mergeTextCollection">mergeTextCollection</a>
        </li>
        <li><a href="global.html#mergeTextMessage">mergeTextMessage</a></li>
        <li>
          <a href="global.html#messagePromptAssist">messagePromptAssist</a>
        </li>
        <li>
          <a href="global.html#messageTypeCollection">messageTypeCollection</a>
        </li>
        <li>
          <a href="global.html#modelGlobalCollection">modelGlobalCollection</a>
        </li>
        <li><a href="global.html#modulePackageName">modulePackageName</a></li>
        <li><a href="global.html#navigationAssist">navigationAssist</a></li>
        <li>
          <a href="global.html#notificationPromptAssist"
            >notificationPromptAssist</a
          >
        </li>
        <li><a href="global.html#parseQueryString">parseQueryString</a></li>
        <li><a href="global.html#preparationWork">preparationWork</a></li>
        <li>
          <a href="global.html#pretreatmentRemoteListData"
            >pretreatmentRemoteListData</a
          >
        </li>
        <li>
          <a href="global.html#pretreatmentRemotePageListData"
            >pretreatmentRemotePageListData</a
          >
        </li>
        <li>
          <a href="global.html#pretreatmentRemoteSingleData"
            >pretreatmentRemoteSingleData</a
          >
        </li>
        <li>
          <a href="global.html#pretreatmentRequestParameters"
            >pretreatmentRequestParameters</a
          >
        </li>
        <li><a href="global.html#progressAssist">progressAssist</a></li>
        <li><a href="global.html#refitCommonData">refitCommonData</a></li>
        <li>
          <a href="global.html#refitFieldDecoratorOption"
            >refitFieldDecoratorOption</a
          >
        </li>
        <li>
          <a href="global.html#removeCurrentOperatorCache"
            >removeCurrentOperatorCache</a
          >
        </li>
        <li><a href="global.html#removeEndMatch">removeEndMatch</a></li>
        <li><a href="global.html#removeFromArray">removeFromArray</a></li>
        <li><a href="global.html#removeLastMatch">removeLastMatch</a></li>
        <li>
          <a href="global.html#removeLocalAuthorityCollection"
            >removeLocalAuthorityCollection</a
          >
        </li>
        <li>
          <a href="global.html#removeLocalMetaData">removeLocalMetaData</a>
        </li>
        <li><a href="global.html#removeLocalStorage">removeLocalStorage</a></li>
        <li>
          <a href="global.html#removeModelNameList">removeModelNameList</a>
        </li>
        <li>
          <a href="global.html#removeParametersDataCache"
            >removeParametersDataCache</a
          >
        </li>
        <li>
          <a href="global.html#removeSessionStorage">removeSessionStorage</a>
        </li>
        <li><a href="global.html#removeToken">removeToken</a></li>
        <li><a href="global.html#replace">replace</a></li>
        <li><a href="global.html#replaceWithKeep">replaceWithKeep</a></li>
        <li><a href="global.html#request">request</a></li>
        <li>
          <a href="global.html#requestConfiguration">requestConfiguration</a>
        </li>
        <li><a href="global.html#requestMethod">requestMethod</a></li>
        <li><a href="global.html#requestMode">requestMode</a></li>
        <li>
          <a href="global.html#runtimeConfiguration">runtimeConfiguration</a>
        </li>
        <li>
          <a href="global.html#saveJsonToLocalStorage"
            >saveJsonToLocalStorage</a
          >
        </li>
        <li>
          <a href="global.html#saveJsonToSessionStorage"
            >saveJsonToSessionStorage</a
          >
        </li>
        <li>
          <a href="global.html#saveStringToLocalStorage"
            >saveStringToLocalStorage</a
          >
        </li>
        <li>
          <a href="global.html#saveStringToSessionStorage"
            >saveStringToSessionStorage</a
          >
        </li>
        <li><a href="global.html#searchFromList">searchFromList</a></li>
        <li><a href="global.html#seededRandom">seededRandom</a></li>
        <li>
          <a href="global.html#sessionStorageAssist">sessionStorageAssist</a>
        </li>
        <li>
          <a href="global.html#setApplicationExternalConfigList"
            >setApplicationExternalConfigList</a
          >
        </li>
        <li>
          <a href="global.html#setApplicationInitialConfig"
            >setApplicationInitialConfig</a
          >
        </li>
        <li>
          <a href="global.html#setAuthenticationFailCode"
            >setAuthenticationFailCode</a
          >
        </li>
        <li>
          <a href="global.html#setAuthenticationFailHandler"
            >setAuthenticationFailHandler</a
          >
        </li>
        <li>
          <a href="global.html#setAuthorizationFailHandler"
            >setAuthorizationFailHandler</a
          >
        </li>
        <li><a href="global.html#setCache">setCache</a></li>
        <li>
          <a href="global.html#setCurrentOperatorCache"
            >setCurrentOperatorCache</a
          >
        </li>
        <li>
          <a href="global.html#setDurationConversionRatio"
            >setDurationConversionRatio</a
          >
        </li>
        <li>
          <a href="global.html#setErrorMessageDisplayMonitor"
            >setErrorMessageDisplayMonitor</a
          >
        </li>
        <li>
          <a href="global.html#setErrorNotificationDisplayMonitor"
            >setErrorNotificationDisplayMonitor</a
          >
        </li>
        <li><a href="global.html#setExpiration">setExpiration</a></li>
        <li>
          <a href="global.html#setGlobalHeaderSupplementHandler"
            >setGlobalHeaderSupplementHandler</a
          >
        </li>
        <li>
          <a href="global.html#setInfoMessageDisplayMonitor"
            >setInfoMessageDisplayMonitor</a
          >
        </li>
        <li>
          <a href="global.html#setInfoNotificationDisplayMonitor"
            >setInfoNotificationDisplayMonitor</a
          >
        </li>
        <li>
          <a href="global.html#setLoadingMessageDisplayMonitor"
            >setLoadingMessageDisplayMonitor</a
          >
        </li>
        <li>
          <a href="global.html#setLoadingNotificationDisplayMonitor"
            >setLoadingNotificationDisplayMonitor</a
          >
        </li>
        <li>
          <a href="global.html#setLocalAuthorityCollection"
            >setLocalAuthorityCollection</a
          >
        </li>
        <li><a href="global.html#setLocalMetaData">setLocalMetaData</a></li>
        <li>
          <a href="global.html#setLocalStorageFlusher"
            >setLocalStorageFlusher</a
          >
        </li>
        <li>
          <a href="global.html#setLocalStorageGetter">setLocalStorageGetter</a>
        </li>
        <li>
          <a href="global.html#setLocalStorageRemover"
            >setLocalStorageRemover</a
          >
        </li>
        <li>
          <a href="global.html#setLocalStorageSetter">setLocalStorageSetter</a>
        </li>
        <li>
          <a href="global.html#setLoggerDisplaySwitch"
            >setLoggerDisplaySwitch</a
          >
        </li>
        <li><a href="global.html#setModelNameList">setModelNameList</a></li>
        <li><a href="global.html#setMultiCache">setMultiCache</a></li>
        <li><a href="global.html#setNavigator">setNavigator</a></li>
        <li>
          <a href="global.html#setOpenMessageDisplayMonitor"
            >setOpenMessageDisplayMonitor</a
          >
        </li>
        <li>
          <a href="global.html#setOpenNotificationDisplayMonitor"
            >setOpenNotificationDisplayMonitor</a
          >
        </li>
        <li>
          <a href="global.html#setParametersDataCache"
            >setParametersDataCache</a
          >
        </li>
        <li><a href="global.html#setPrepareCallback">setPrepareCallback</a></li>
        <li>
          <a href="global.html#setProgressStartHandler"
            >setProgressStartHandler</a
          >
        </li>
        <li>
          <a href="global.html#setProgressStopHandler"
            >setProgressStopHandler</a
          >
        </li>
        <li>
          <a href="global.html#setPromptSimulation">setPromptSimulation</a>
        </li>
        <li><a href="global.html#setRedirector">setRedirector</a></li>
        <li><a href="global.html#setRequestHandler">setRequestHandler</a></li>
        <li>
          <a href="global.html#setRuntimeDataStorage">setRuntimeDataStorage</a>
        </li>
        <li>
          <a href="global.html#setSessionStorageFlusher"
            >setSessionStorageFlusher</a
          >
        </li>
        <li>
          <a href="global.html#setSessionStorageGetter"
            >setSessionStorageGetter</a
          >
        </li>
        <li>
          <a href="global.html#setSessionStorageRemover"
            >setSessionStorageRemover</a
          >
        </li>
        <li>
          <a href="global.html#setSessionStorageSetter"
            >setSessionStorageSetter</a
          >
        </li>
        <li>
          <a href="global.html#setSimulationAuthorizeExtraHandler"
            >setSimulationAuthorizeExtraHandler</a
          >
        </li>
        <li><a href="global.html#setSuccessCode">setSuccessCode</a></li>
        <li>
          <a href="global.html#setSuccessMessageDisplayMonitor"
            >setSuccessMessageDisplayMonitor</a
          >
        </li>
        <li>
          <a href="global.html#setSuccessNotificationDisplayMonitor"
            >setSuccessNotificationDisplayMonitor</a
          >
        </li>
        <li><a href="global.html#setToken">setToken</a></li>
        <li><a href="global.html#setUrlGlobalPrefix">setUrlGlobalPrefix</a></li>
        <li>
          <a href="global.html#setWarnMessageDisplayMonitor"
            >setWarnMessageDisplayMonitor</a
          >
        </li>
        <li>
          <a href="global.html#setWarnNotificationDisplayMonitor"
            >setWarnNotificationDisplayMonitor</a
          >
        </li>
        <li>
          <a href="global.html#setWarningMessageDisplayMonitor"
            >setWarningMessageDisplayMonitor</a
          >
        </li>
        <li>
          <a href="global.html#setWarningNotificationDisplayMonitor"
            >setWarningNotificationDisplayMonitor</a
          >
        </li>
        <li><a href="global.html#showErrorMessage">showErrorMessage</a></li>
        <li>
          <a href="global.html#showErrorNotification">showErrorNotification</a>
        </li>
        <li><a href="global.html#showInfoMessage">showInfoMessage</a></li>
        <li>
          <a href="global.html#showInfoNotification">showInfoNotification</a>
        </li>
        <li><a href="global.html#showLoadingMessage">showLoadingMessage</a></li>
        <li>
          <a href="global.html#showLoadingNotification"
            >showLoadingNotification</a
          >
        </li>
        <li><a href="global.html#showOpenMessage">showOpenMessage</a></li>
        <li>
          <a href="global.html#showOpenNotification">showOpenNotification</a>
        </li>
        <li><a href="global.html#showRuntimeError">showRuntimeError</a></li>
        <li>
          <a href="global.html#showSimpleErrorMessage"
            >showSimpleErrorMessage</a
          >
        </li>
        <li>
          <a href="global.html#showSimpleErrorNotification"
            >showSimpleErrorNotification</a
          >
        </li>
        <li>
          <a href="global.html#showSimpleInfoMessage">showSimpleInfoMessage</a>
        </li>
        <li>
          <a href="global.html#showSimpleInfoNotification"
            >showSimpleInfoNotification</a
          >
        </li>
        <li>
          <a href="global.html#showSimpleLoadingMessage"
            >showSimpleLoadingMessage</a
          >
        </li>
        <li>
          <a href="global.html#showSimpleLoadingNotification"
            >showSimpleLoadingNotification</a
          >
        </li>
        <li>
          <a href="global.html#showSimpleOpenMessage">showSimpleOpenMessage</a>
        </li>
        <li>
          <a href="global.html#showSimpleOpenNotification"
            >showSimpleOpenNotification</a
          >
        </li>
        <li>
          <a href="global.html#showSimpleRuntimeError"
            >showSimpleRuntimeError</a
          >
        </li>
        <li>
          <a href="global.html#showSimpleSuccessMessage"
            >showSimpleSuccessMessage</a
          >
        </li>
        <li>
          <a href="global.html#showSimpleSuccessNotification"
            >showSimpleSuccessNotification</a
          >
        </li>
        <li>
          <a href="global.html#showSimpleWarnMessage">showSimpleWarnMessage</a>
        </li>
        <li>
          <a href="global.html#showSimpleWarnNotification"
            >showSimpleWarnNotification</a
          >
        </li>
        <li>
          <a href="global.html#showSimpleWarningMessage"
            >showSimpleWarningMessage</a
          >
        </li>
        <li>
          <a href="global.html#showSimpleWarningNotification"
            >showSimpleWarningNotification</a
          >
        </li>
        <li><a href="global.html#showSuccessMessage">showSuccessMessage</a></li>
        <li>
          <a href="global.html#showSuccessNotification"
            >showSuccessNotification</a
          >
        </li>
        <li><a href="global.html#showWarnMessage">showWarnMessage</a></li>
        <li>
          <a href="global.html#showWarnNotification">showWarnNotification</a>
        </li>
        <li><a href="global.html#showWarningMessage">showWarningMessage</a></li>
        <li>
          <a href="global.html#showWarningNotification"
            >showWarningNotification</a
          >
        </li>
        <li><a href="global.html#shuffleArray">shuffleArray</a></li>
        <li>
          <a href="global.html#simulateFailRequest">simulateFailRequest</a>
        </li>
        <li><a href="global.html#simulateRequest">simulateRequest</a></li>
        <li>
          <a href="global.html#simulateSuccessRequest"
            >simulateSuccessRequest</a
          >
        </li>
        <li><a href="global.html#sleep">sleep</a></li>
        <li><a href="global.html#sortBy">sortBy</a></li>
        <li>
          <a href="global.html#sortCollectionByKey">sortCollectionByKey</a>
        </li>
        <li><a href="global.html#sortOperate">sortOperate</a></li>
        <li><a href="global.html#sortedUnique">sortedUnique</a></li>
        <li><a href="global.html#statisticsCache">statisticsCache</a></li>
        <li><a href="global.html#stringifyJson">stringifyJson</a></li>
        <li><a href="global.html#takeCache">takeCache</a></li>
        <li><a href="global.html#throttle">throttle</a></li>
        <li><a href="global.html#to">to</a></li>
        <li><a href="global.html#toBoolean">toBoolean</a></li>
        <li><a href="global.html#toBoundary">toBoundary</a></li>
        <li><a href="global.html#toDatetime">toDatetime</a></li>
        <li><a href="global.html#toLower">toLower</a></li>
        <li><a href="global.html#toLowerFirst">toLowerFirst</a></li>
        <li><a href="global.html#toMoney">toMoney</a></li>
        <li><a href="global.html#toNumber">toNumber</a></li>
        <li><a href="global.html#toPercentage">toPercentage</a></li>
        <li><a href="global.html#toPrecision">toPrecision</a></li>
        <li><a href="global.html#toPromise">toPromise</a></li>
        <li><a href="global.html#toRound">toRound</a></li>
        <li><a href="global.html#toSha1">toSha1</a></li>
        <li><a href="global.html#toString">toString</a></li>
        <li><a href="global.html#toUniqueArray">toUniqueArray</a></li>
        <li><a href="global.html#toUpper">toUpper</a></li>
        <li><a href="global.html#transformData">transformData</a></li>
        <li><a href="global.html#transformListData">transformListData</a></li>
        <li><a href="global.html#transparentImage">transparentImage</a></li>
        <li><a href="global.html#trim">trim</a></li>
        <li>
          <a href="global.html#trySendNearestLocalhostNotify"
            >trySendNearestLocalhostNotify</a
          >
        </li>
        <li>
          <a href="global.html#underlyingExtensionState"
            >underlyingExtensionState</a
          >
        </li>
        <li><a href="global.html#underlyingState">underlyingState</a></li>
        <li><a href="global.html#whetherNumber">whetherNumber</a></li>
        <li><a href="global.html#whetherString">whetherString</a></li>
        <li><a href="global.html#zeroInt">zeroInt</a></li>
        <li><a href="global.html#zeroString">zeroString</a></li>
      </ul>
    </nav>

    <div id="main">
      <h1 class="page-title">requestAssist.js</h1>

      <section>
        <article>
          <pre
            class="prettyprint source linenums"
          ><code>import { setCache } from './cacheAssist';
import {
  checkInCollection,
  checkStringIsNullOrWhiteSpace,
  isBoolean,
  isFunction,
  isNumber,
  isObject,
  isString,
  isUndefined,
} from './checkAssist';
import { requestMethod, requestMode } from './constants';
import { toBoolean, toLower, toNumber, toUpper } from './convertAssist';
import { modulePackageName } from './definition';
import { adjustUrl } from './httpAssist';
import { trim } from './lodashTools';
import {
  logDebug,
  logDevelop,
  logError,
  logExecute,
  logTrace,
  logWarn,
} from './loggerAssist';
import {
  showSimpleErrorMessage,
  showSimpleInfoMessage,
  showSimpleRuntimeError,
  showSimpleWarningMessage,
  showSimpleWarnMessage,
} from './messagePromptAssist';
import { buildPromptModuleInfo } from './promptAssist';
import { buildQueryStringify } from './queryString';
import {
  getLastRequestExceptionMessage,
  setLastRequestExceptionMessage,
} from './runtimeAssist';
import { getToken } from './tokenAssist';
import { mergeTextMessage } from './tools';

/**
 * Module Name.
 * @private
 */
const moduleName = 'requestAssist';

function buildPromptModuleInfoText(text, ancillaryInformation = '') {
  return buildPromptModuleInfo(
    modulePackageName,
    mergeTextMessage(text, ancillaryInformation),
    moduleName,
  );
}

/**
 * Simulation Configuration
 */
export const requestConfiguration = {
  successCodeSetComplete: false,
  authenticationFailCodeSetComplete: false,
  successCode: 200,
  authenticationFailCode: 2001,
  promptSimulation: false,
  promptSimulationSetComplete: false,
  urlGlobalPrefix: '',
  handleSupplementGlobalHeader: () => {
    return {};
  },
  handleSupplementGlobalHeaderSetComplete: false,
  handleRequest: async ({
    // eslint-disable-next-line no-unused-vars
    url,
    // eslint-disable-next-line no-unused-vars
    method = requestMethod.post,
    // eslint-disable-next-line no-unused-vars
    data = {},
    // eslint-disable-next-line no-unused-vars
    header = [],
    // eslint-disable-next-line no-unused-vars
    option = {},
  }) => {},
  handleRequestSetComplete: false,
  handleAuthenticationFail: () => {},
  handleAuthenticationFailSetComplete: false,
  handleSimulationAuthorizeExtra: () => true,
  handleSimulationAuthorizeExtraSetComplete: false,
};

/**
 * Set request success code
 * @param {number} code success code
 */
export function setSuccessCode(code) {
  if (requestConfiguration.successCodeSetComplete) {
    logDevelop(
      'setSuccessCode',
      'reset is not allowed, it can be set only once',
    );

    return;
  }

  if (isNumber(code)) {
    logDevelop('setSuccessCode', toNumber(code));
  } else {
    logDevelop('setSuccessCode', 'parameter must be number');
  }

  requestConfiguration.successCode = toNumber(code);
  requestConfiguration.successCodeSetComplete = true;
}

/**
 * Set request authentication fail code
 * @param {number} code authentication fail code
 */
export function setAuthenticationFailCode(code) {
  if (requestConfiguration.authenticationFailCodeSetComplete) {
    logDevelop(
      'setAuthenticationFailCode',
      'reset is not allowed, it can be set only once',
    );

    return;
  }

  if (isNumber(code)) {
    logDevelop('setAuthenticationFailCode', toNumber(code));
  } else {
    logDevelop('setAuthenticationFailCode', 'parameter must be number');
  }

  requestConfiguration.authenticationFailCode = toNumber(code);
  requestConfiguration.authenticationFailCodeSetComplete = true;
}

/**
 * Set prompt simulative request
 * @param {boolean} value whether prompt simulative request
 */
export function setPromptSimulation(value) {
  if (requestConfiguration.promptSimulationSetComplete) {
    logDevelop(
      'setPromptSimulation',
      'reset is not allowed, it can be set only once',
    );

    return;
  }

  if (isBoolean(value)) {
    logDevelop('setPromptSimulation', toBoolean(value));
  } else {
    logDevelop('setPromptSimulation', 'parameter must be bool');
  }

  requestConfiguration.promptSimulation = toBoolean(value);
  requestConfiguration.promptSimulationSetComplete = true;
}

/**
 * Set the url global prefix
 * @param {string} globalPrefix url global prefix, eg "V1" like api version
 */
export function setUrlGlobalPrefix(globalPrefix) {
  if (!isString(globalPrefix)) {
    throw new Error(
      buildPromptModuleInfoText(
        `setUrlGlobalPrefix param globalPrefix need string`,
        `current is ${typeof globalPrefix}`,
      ),
    );
  }

  requestConfiguration.urlGlobalPrefix = globalPrefix;
}

/**
 * Set the real request handler
 * @param {Function} handler handle real request
 */
export function setRequestHandler(handler) {
  if (requestConfiguration.handleRequestSetComplete) {
    logDevelop(
      'setRequestHandler',
      'reset is not allowed, it can be set only once',
    );

    return;
  }

  if (isFunction(handler)) {
    logDevelop(
      buildPromptModuleInfoText('setRequestHandler'),
      typeof callbackMonitor,
    );
  } else {
    logDevelop(
      buildPromptModuleInfoText('setRequestHandler'),
      'parameter must be function',
    );
  }

  requestConfiguration.handleRequest = handler;
  requestConfiguration.handleRequestSetComplete = true;
}

/**
 * Set the authentication fail handler
 * @param {Function} handler handle authentication fail
 */
export function setAuthenticationFailHandler(handler) {
  if (requestConfiguration.handleAuthenticationFailSetComplete) {
    logDevelop(
      'setAuthenticationFailHandler',
      'reset is not allowed, it can be set only once',
    );

    return;
  }

  if (isFunction(handler)) {
    logDevelop('setAuthenticationFailHandler', typeof handler);
  } else {
    logDevelop('setAuthenticationFailHandler', 'parameter must be function');
  }

  requestConfiguration.handleAuthenticationFail = handler;
  requestConfiguration.handleAuthenticationFailSetComplete = true;
}

/**
 * Set the simulation authorize extra handler
 * @param {Function} handler handle simulation authorize extra
 */
export function setSimulationAuthorizeExtraHandler(handler) {
  if (requestConfiguration.handleSimulationAuthorizeExtraSetComplete) {
    logDevelop(
      'setSimulationAuthorizeExtraHandler',
      'reset is not allowed, it can be set only once',
    );

    return;
  }

  if (isFunction(handler)) {
    logDevelop('setSimulationAuthorizeExtraHandler', typeof handler);
  } else {
    logDevelop(
      'setSimulationAuthorizeExtraHandler',
      'parameter must be function',
    );
  }

  requestConfiguration.handleSimulationAuthorizeExtra = handler;
  requestConfiguration.handleSimulationAuthorizeExtraSetComplete = true;
}

/**
 * Set the global header handler supplement
 * @param {Function} handler handle global header handler supplement
 */
export function setGlobalHeaderSupplementHandler(handler) {
  if (requestConfiguration.handleSupplementGlobalHeaderSetComplete) {
    logDevelop(
      'setGlobalHeaderSupplementHandler',
      'reset is not allowed, it can be set only once',
    );

    return;
  }

  if (isFunction(handler)) {
    logDevelop('setGlobalHeaderSupplementHandler', typeof handler);
  } else {
    logDevelop(
      'setGlobalHeaderSupplementHandler',
      'parameter must be function',
    );
  }

  requestConfiguration.handleSupplementGlobalHeader = handler;
  requestConfiguration.handleSupplementGlobalHeaderSetComplete = true;
}

/**
 * 错误数据模型
 */
function errorCustomData() {
  return {
    code: -1,
    message: '',
    data: null,
    list: [],
    extra: null,
  };
}

/**
 * 数据异常通知
 * @param {*} d 异常数据
 */
function dataExceptionNotice(d) {
  const { code, message: messageText } = d;
  const c = errorCustomData();

  const lastCustomMessage = getLastRequestExceptionMessage();

  const codeAdjust = toNumber(code);

  if (codeAdjust !== c.code) {
    const currentTime = Date.now();

    if (codeAdjust === requestConfiguration.authenticationFailCode) {
      logDebug(`api call failed, authentication fail`);
    } else {
      logWarn(`api call failed, code: ${codeAdjust}, message: ${messageText}`);

      if (codeAdjust === toNumber(lastCustomMessage.code)) {
        if (currentTime - lastCustomMessage.time > 800) {
          showSimpleErrorMessage(messageText);

          setLastRequestExceptionMessage({
            code: codeAdjust,
            message: messageText,
            time: currentTime,
          });
        }
      } else {
        showSimpleErrorMessage(messageText);

        setLastRequestExceptionMessage({
          code: codeAdjust,
          message: messageText,
          time: currentTime,
        });
      }
    }

    if (codeAdjust === requestConfiguration.authenticationFailCode) {
      handleAuthenticationFail();
    }
  }
}

/**
 * Pretreatment remote object data
 * @param {Object} options request options
 * @param {Object} options.source source object data
 * @param {Function|null} options.pretreatment pretreatment source object data
 * @param {Function|null} options.successCallback success callback handler
 * @param {Function|null} options.failCallback fail callback handler
 */
export function pretreatmentRemoteSingleData({
  source,
  pretreatment = null,
  successCallback = null,
  failCallback = null,
}) {
  const { code, message } = {
    ...errorCustomData(),
    ...source,
  };

  let v = {};

  const codeAdjust = toNumber(code);

  if (codeAdjust === toNumber(requestConfiguration.successCode)) {
    const { data, extra } = source;

    if (isFunction(pretreatment)) {
      v = pretreatment(source);
    }

    v = {
      code: codeAdjust,
      message,
      data: data || {},
      extra: extra || {},
      dataSuccess: true,
    };

    if (isFunction(successCallback)) {
      successCallback(v);
    }
  } else {
    v = {
      code: codeAdjust,
      message: message || '网络异常',
      data: null,
      extra: null,
      dataSuccess: false,
    };

    if (isFunction(failCallback)) {
      failCallback(v);
    }

    dataExceptionNotice(v);
  }

  return v;
}

/**
 * Pretreatment remote list data
 * @param {Object} options handler options
 * @param {Array} options.source source list data
 * @param {Function|null} options.pretreatment pretreatment source list data
 * @param {Function|null} options.itemPretreatment pretreatment source list data item
 * @param {Function|null} options.successCallback success callback handler
 * @param {Function|null} options.failCallback fail callback handler
 */
export function pretreatmentRemoteListData({
  source,
  pretreatment = null,
  itemPretreatment = null,
  successCallback = null,
  failCallback = null,
}) {
  const { code, message } = source || errorCustomData();
  let v = {};

  const codeAdjust = toNumber(code);

  if (codeAdjust === toNumber(requestConfiguration.successCode)) {
    let sourceAdjust = source;

    if (isFunction(pretreatment)) {
      sourceAdjust = pretreatment(source);
    }

    const { list: listData, extra: extraData } = sourceAdjust;
    const list = (listData || []).map((item, index) => {
      let o = item;

      if ((o.key || null) == null) {
        o.key = `list-${index}`;
      }

      if (isFunction(itemPretreatment)) {
        o = itemPretreatment(o);
      }

      return o;
    });

    v = {
      code: codeAdjust,
      message,
      count: (list || []).length,
      list,
      extra: extraData,
      dataSuccess: true,
    };

    if (isFunction(successCallback)) {
      successCallback(v);
    }
  } else {
    v = {
      code: codeAdjust,
      message: message || '网络异常',
      count: 0,
      list: [],
      extra: null,
      dataSuccess: false,
    };

    if (isFunction(failCallback)) {
      failCallback(v);
    }

    dataExceptionNotice(v);
  }

  return v;
}

/**
 * Pretreatment remote page list data
 * @param {Object} options handler options
 * @param {Array} options.source source page list data
 * @param {Function|null} options.pretreatment pretreatment source page list data
 * @param {Function|null} options.itemPretreatment pretreatment source page list data item
 * @param {Function|null} options.successCallback success callback handler
 * @param {Function|null} options.failCallback fail callback handler
 */
export function pretreatmentRemotePageListData({
  source,
  pretreatment = null,
  itemPretreatment = null,
  successCallback = null,
  failCallback = null,
}) {
  const { code, message: messageText } = source || errorCustomData();
  let v = {};

  const codeAdjust = toNumber(code);

  if (codeAdjust === toNumber(requestConfiguration.successCode)) {
    let sourceAdjust = source;

    if (isFunction(pretreatment)) {
      sourceAdjust = pretreatment(source);
    }

    const { list: listData, extra: extraData } = sourceAdjust;
    const { pageNo, total, pageSize } = extraData;
    const list = (listData || []).map((item, index) => {
      let o = item;

      if ((o.key || null) == null) {
        o.key = `${pageNo}-${index}`;
      }

      if (isFunction(itemPretreatment)) {
        o = itemPretreatment(o);
      }

      return o;
    });

    v = {
      code: codeAdjust,
      message: messageText,
      count: (list || []).length,
      list,
      pagination: {
        total: total,
        pageSize: pageSize,
        current: Number.parseInt(pageNo || 1, 10) || 1,
      },
      extra: extraData,
      dataSuccess: true,
    };

    if (isFunction(successCallback)) {
      successCallback(v);
    }
  } else {
    v = {
      code: codeAdjust,
      message: messageText || '网络异常',
      count: 0,
      list: [],
      extra: null,
      pagination: {
        total: 0,
        pageSize: 10,
        current: 1,
      },
      dataSuccess: false,
    };

    if (isFunction(failCallback)) {
      failCallback(v);
    }

    dataExceptionNotice(v);
  }
  return v;
}

/**
 * Pretreatment request parameters
 * @param {Object} parameters the parameters will pretreatment
 * @param {Function} customHandle custom handler
 */
export function pretreatmentRequestParameters(parameters, customHandle) {
  let submitData = { ...parameters };

  if (typeof customHandle === 'function') {
    submitData = customHandle(submitData);
  }

  //过滤值为空(undefined、null)
  return Object.fromEntries(
    Object.keys(submitData)
      .filter((k) => submitData[k] != null)
      .map((k) => [k, submitData[k]]),
  );
}

/**
 * handle list data assist
 * @param {Object} state state
 * @param {Object} action action
 * @param {string} namespace model namespace
 */
export function handleListDataAssist(state, action, namespace) {
  const { payload: d, callback, pretreatment, alias, cacheData } = action;

  let v = pretreatmentRemoteListData(d, pretreatment);

  if (isFunction(callback)) {
    v = callback(v);
  }

  let result = null;

  if (isUndefined(alias) || !isString(alias)) {
    return {
      ...state,
      data: v,
    };
  } else {
    result = {
      ...state,
    };

    result[alias] = v;
  }

  if (cacheData) {
    const key = `${namespace}_${alias || 'data'}`;

    const cacheResult = setCache({
      key,
      value: v,
    });

    logDebug(
      `modal ${namespace} cache data, key is ${namespace}_${alias || 'data'}, ${
        cacheResult ? 'cache success' : 'cache fail'
      }.`,
    );
  }

  return result;
}

export function handlePageListDataAssist(state, action, namespace) {
  const { payload: d, callback, pretreatment, alias, cacheData } = action;

  let v = pretreatmentRemotePageListData(d, pretreatment);

  if (isFunction(callback)) {
    v = callback(v);
  }

  let result = null;

  if (isUndefined(alias) || !isString(alias)) {
    return {
      ...state,
      data: v,
    };
  } else {
    result = {
      ...state,
    };

    result[alias] = v;
  }

  if (cacheData) {
    const key = `${namespace}_${alias || 'data'}`;

    const cacheResult = setCache({
      key,
      value: v,
    });

    logDevelop(
      `modal ${namespace} cache data, key is ${namespace}_${alias || 'data'}, ${
        cacheResult ? 'cache success' : 'cache fail'
      }.`,
    );
  }

  return result;
}

async function realRequest({
  url,
  method = requestMethod.post,
  data = {},
  header = [],
  option = {},
}) {
  logExecute(
    {
      url,
      method,
      data,
      header,
      option,
    },
    buildPromptModuleInfoText(`realRequest"`),
  );

  let headerAdjust = header;

  if (
    requestConfiguration.handleSupplementGlobalHeaderSetComplete &amp;&amp;
    isFunction(requestConfiguration.handleSupplementGlobalHeader)
  ) {
    const supplementData = requestConfiguration.handleSupplementGlobalHeader();

    if (isObject(supplementData)) {
      headerAdjust = { ...header, ...supplementData };
    }
  }

  if (!requestConfiguration.handleRequestSetComplete) {
    throw new Error(
      buildPromptModuleInfoText(
        'realRequest',
        'handleRequest has not set, please use setRequestHandler to set it',
      ),
    );
  }

  return await requestConfiguration.handleRequest({
    url,
    method,
    data,
    header: headerAdjust,
    option,
  });
}

export function handleAuthenticationFail() {
  if (!requestConfiguration.handleAuthenticationFailSetComplete) {
    throw new Error(
      buildPromptModuleInfoText(
        'handleAuthenticationFail',
        'handleAuthenticationFail has not set, please use setAuthenticationFailHandler to set it',
      ),
    );
  }

  requestConfiguration.handleAuthenticationFail();
}

export function handleSimulationAuthorizeExtra() {
  if (!isFunction(requestConfiguration.handleSimulationAuthorizeExtra)) {
    logDevelop(
      buildPromptModuleInfoText(
        'handleSimulationAuthorizeExtra',
        'handleSimulationAuthorizeExtra is not function, ignore execute, if you need it, please use setSimulationAuthorizeExtraHandler to set it',
      ),
    );

    return true;
  }

  return requestConfiguration.handleSimulationAuthorizeExtra();
}

/**
 * Begin request（remote request / local simulate requests）
 * @param {Object} option request option
 * @param {string} option.api request address
 * @param {Object} option.params request params
 * @param {Object} option.header request header
 * @param {string} option.method "GET"/"POST"/"PUT"/"DELETE", default is requestMethod.post
 * @param {string} option.mode request mode, default is requestMode.real
 * @param {boolean} option.promptSimulation whether display simulate request message prompt
 * @param {number} option.promptSimulationDelay display simulate request message prompt delay time, default is 500
 * @param {number} option.simulateRequestMaxDelay simulate request max delay time, default is 0
 * @param {Object} option.simulativeSuccessResponse simulate request success response
 * @param {Object} option.simulativeFailResponse simulate request fail response
 * @param {boolean} option.simulateRequestResult specifies whether the result is successful, generally used to debug
 * @param {boolean} option.simulativeAuthorize set simulate request whether check token, only check mull or empty, generally used to debug
 */
export async function request({
  api,
  urlParams: urlParameters = null,
  params: parameters = {},
  header = {},
  method = requestMethod.post,
  mode = requestMode.real,
  promptSimulation = requestConfiguration.promptSimulation,
  promptSimulationDelay = 500,
  simulateRequestMaxDelay = 0,
  simulativeSuccessResponse = {},
  simulativeFailResponse = {
    code: 1001,
    message: '虚拟未知错误',
  },
  simulateRequestResult = true,
  simulativeAuthorize = false,
}) {
  let globalPrefix = requestConfiguration.urlGlobalPrefix;

  if (!isString(globalPrefix)) {
    logWarn(globalPrefix, `error globalPrefix`);

    throw new Error('url global prefix is not string');
  }

  if (!isString(api)) {
    logWarn(api, `error api`);

    throw new Error('api is not string');
  }

  let url = api;

  if (
    toLower(url).startsWith('http://') ||
    toLower(url).startsWith('https://')
  ) {
    url = api;
  } else {
    if (!checkStringIsNullOrWhiteSpace(globalPrefix)) {
      globalPrefix = `/${globalPrefix}/`;
    }

    url = `${globalPrefix}${api}`.replace('//', '/');
  }

  url = adjustUrl(url);

  if ((urlParameters || null) != null) {
    if (isString(urlParameters)) {
      url = `${url}?${urlParameters}`;
    }

    if (isObject(urlParameters)) {
      url = `${url}?${buildQueryStringify(urlParameters)}`;
    }
  }

  if (mode === requestMode.simulation) {
    logTrace(
      `api request is simulation mode, simulate start,${
        simulateRequestMaxDelay > 0
          ? `max delay ${simulateRequestMaxDelay}ms,`
          : ''
      } api is "${api}".`,
    );

    if (promptSimulation) {
      setTimeout(
        () => {
          const text = '由虚拟访问返回';

          showSimpleInfoMessage(text);
        },
        promptSimulationDelay > 0 ? promptSimulationDelay : 0,
      );
    }

    let result = {};
    let verifyToken = false;

    if (simulativeAuthorize) {
      const token = getToken();

      if (!checkStringIsNullOrWhiteSpace(token)) {
        verifyToken = true;
      }

      if (isFunction(requestConfiguration.handleSimulationAuthorizeExtra)) {
        verifyToken =
          requestConfiguration.handleSimulationAuthorizeExtra() || false;
      } else {
        throw new Error(
          'handleSimulationAuthorizeExtra must be function and return boolean',
        );
      }
    }

    if (simulativeAuthorize &amp;&amp; !verifyToken) {
      handleAuthenticationFail();
    } else {
      logTrace(
        {
          api,
          method,
          header,
          urlParams: urlParameters,
          params: parameters,
          apiVersion: globalPrefix,
          mode,
          simulateRequestMaxDelay,
          simulativeAuthorize,
        },
        buildPromptModuleInfoText(
          'request',
          `simulation request address: "${url}"`,
        ),
      );

      result = await simulateRequest({
        api: api,
        simulateRequestMaxDelay,
        dataBuild: (resolve) => {
          if (simulateRequestResult) {
            resolve(
              buildSimulateRequestSuccessResponse({
                response: simulativeSuccessResponse,
                needAuthorize: simulativeAuthorize,
              }),
            );
          } else {
            resolve(
              buildSimulateRequestFailResponse({
                response: simulativeFailResponse,
                needAuthorize: simulativeAuthorize,
              }),
            );
          }
        },
      });

      logTrace(
        {
          response: result,
        },
        buildPromptModuleInfoText('request', `simulation request complete`),
      );
    }

    return result;
  }

  logTrace(
    {
      api,
      method,
      header,
      urlParams: urlParameters,
      params: parameters,
      apiVersion: globalPrefix,
      mode,
    },
    buildPromptModuleInfoText('request', `request address: "${url}"`),
  );

  const methodAdjust = trim(toUpper(method));

  if (
    checkInCollection([requestMethod.get, requestMethod.post], methodAdjust)
  ) {
    const requestResult = await realRequest({
      url,
      data: parameters,
      header: {
        ...header,
      },
      option: {},
      method: requestMethod.post,
    });

    logTrace(
      {
        requestResult,
      },
      buildPromptModuleInfoText('request', 'real request complete'),
    );

    return requestResult;
  }

  throw new Error(`unsupported method:${method}`);
}

/**
 * 封装模拟的登录验证
 *
 */
function hasToken() {
  const token = getToken();
  return checkStringIsNullOrWhiteSpace(token);
}

/**
 * 封装模拟的错误返回
 */
export function buildSimulateRequestFailResponse({
  response,
  code,
  message,
  needAuthorize = true,
}) {
  if (needAuthorize) {
    if (hasToken()) {
      showSimpleRuntimeError(message);

      return {
        code,
        message,
        success: false,
        ...response,
      };
    }

    return {
      code: requestConfiguration.authenticationFailCode,
      message: '登录失效, 请重新登录',
      success: false,
    };
  }

  showSimpleRuntimeError(message);

  return {
    code,
    message,
    success: false,
    ...response,
  };
}

/**
 * 封装模拟的正确返回
 */
export function buildSimulateRequestSuccessResponse({
  response,
  needAuthorize = true,
}) {
  if (needAuthorize) {
    if (hasToken()) {
      return {
        code: requestConfiguration.successCode,
        message: 'success',
        success: true,
        ...response,
      };
    }

    return {
      code: requestConfiguration.authenticationFailCode,
      message: '登录失效, 请重新登录',
      success: false,
    };
  }

  return {
    code: requestConfiguration.successCode,
    message: 'success',
    success: true,
    ...response,
  };
}

/**
 * 封装正确的虚拟访问
 */
export async function simulateSuccessRequest({
  remoteResponse,
  needAuthorize = true,
}) {
  let result = {};

  await new Promise((resolve) => {
    setTimeout(() => {
      resolve(
        buildSimulateRequestSuccessResponse({
          remoteResponse,
          needAuthorize,
        }),
      );
    }, 300);
  })
    .then((data) => {
      result = data;

      return data;
    })
    .catch((error) => {
      logError(error);
    });

  const { code } = result;

  if (code === requestConfiguration.authenticationFailCode) {
    handleAuthenticationFail();
  }

  return result;
}

/**
 * 封装失败的虚拟访问
 */
export async function simulateFailRequest({
  remoteResponse,
  needAuthorize = true,
}) {
  let result = {};

  await new Promise((resolve) => {
    setTimeout(() => {
      resolve(buildSimulateRequestFailResponse(remoteResponse, needAuthorize));
    }, 300);
  })
    .then((data) => {
      result = data;

      return data;
    })
    .catch((error) => {
      logError(error);
    });

  const { code, message: messageText } = result;

  if (code === requestConfiguration.authenticationFailCode) {
    handleAuthenticationFail();
  } else if (code !== requestConfiguration.successCode) {
    showSimpleWarnMessage(messageText);
  }

  return result;
}

/**
 * 封装模拟访问
 */
export async function simulateRequest({
  api = '',
  simulateRequestMaxDelay = 200,
  dataBuild,
}) {
  let result = {};

  await new Promise((resolve) => {
    if (isFunction(dataBuild)) {
      const simulateRequestDelay =
        simulateRequestMaxDelay > 0
          ? toNumber(Math.random() * simulateRequestMaxDelay)
          : 0;

      logTrace(`api request simulate realy delay ${simulateRequestDelay}ms`);

      setTimeout(() => {
        dataBuild(resolve);
      }, simulateRequestDelay);
    }
  })
    .then((data) => {
      logTrace(`api request simulate completed`, `"${api}"`);

      result = data;

      return data;
    })
    .catch((error) => {
      logError(error);
    });

  const { code, message: messageText } = result;

  if (code !== requestConfiguration.successCode) {
    showSimpleWarningMessage(messageText);
  }

  return result;
}
</code></pre>
        </article>
      </section>
    </div>

    <br class="clear" />

    <footer>
      Documentation generated by
      <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.3</a> on Mon Jul 22
      2024 20:22:10 GMT+0800 (中国标准时间) using the
      <a href="https://github.com/clenemt/docdash">docdash</a> theme.
    </footer>

    <script>
      prettyPrint();
    </script>
    <script src="scripts/polyfill.js"></script>
    <script src="scripts/linenumber.js"></script>
  </body>
</html>
